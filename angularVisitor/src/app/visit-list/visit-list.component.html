<div *ngIf='result'>
    <h3>Visits</h3>
    <div class="text-center">
        <a href="" class="btn btn-default btn-rounded mb-4" data-toggle="modal" data-target="#modalSubscriptionForm">Launch
          Modal Subscription Form</a>
      </div>
    <table class="table">
        <thead class="thead-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Visit To</th>
                <th>Purpose</th>
                <th>CheckIn</th>
                <th>CheckOut</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor='let row of result.results'>
                <td>{{row.id}}</td>
                <td>
                    <span *ngIf='row.visitor_name'>{{row.visitor_name.name}}</span>
                    <span *ngIf='!row.visitor_name'>-</span>
                </td>
                <td>
                    <span *ngIf='row.visit_to'>{{row.visit_to.name}}</span>
                    <span *ngIf='!row.visit_to'>-</span>
                </td>
                <td>
                    <span *ngIf="row.purpose">{{row.purpose}}</span>
                    <span *ngIf='!row.purpose'>-</span>
                </td>
                <td>
                    <span *ngIf='row.checkIn_time'>{{row.checkIn_time}}</span>
                    <span *ngIf='!row.checkIn_time'>
                        <button class="btn btn-primary">Check In</button>
                    </span>
                </td>
                <td>
                    <span *ngIf='row.checkOut_time'>{{row.checkOut_time}}</span>
                    <span *ngIf='!row.checkOut_time'>
                        <button class="btn btn-primary">Check In</button>
                    </span>
                </td>
            </tr>
        </tbody>
</table>
</div>

<div #modal class="modal fade" id="modalSubscriptionForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Subscribe</h4>
        <button type="button" class="close" (click)="resetForm()" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="form-group" *ngIf="!type">
        <label for="type">Type</label>
        <select id="type" (change)="changeEvent($event)" class="form-control">
          <option value="new">New</option>
          <option value="existing">Existing</option>
        </select>
      </div>
        <div *ngIf="type=='existing'">
        <form #myform="ngForm" name="form" (ngSubmit)="myform.form.valid && onSubmit(modal)">
            <div class="form-group" *ngIf="visitors">
                <label for="inputAddress">Visitor</label>
                <!-- <input list="brow" class="form-control"> -->
                <select class="form-control" onmousedown="if(this.options.length>8){this.size=8;}"  onchange='this.size=0;' onblur="this.size=0;" required [(ngModel)]='selectedVisitor' name="visitor">
                    <option *ngFor="let c of visitors.results" [ngValue]="c">{{c.name}}</option>
                </select>
              </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="inputEmail4">Email</label>
                <input type="email" disabled class="form-control" id="inputEmail4" name="visitor_email" placeholder="Email" [(ngModel)]="selectedVisitor.email">
              </div>
              <div class="form-group col-md-6">
                <label for="inputPassword4">Phone</label>
                <input type="text" disabled class="form-control" id="inputPassword4" name="visitor_phone" [(ngModel)]="selectedVisitor.phone" placeholder="Password">
              </div>
            </div>
            
            <div class="form-group">
              <label for="inputAddress">Address</label>
              <input type="text" disabled class="form-control" id="inputAdress" name="visitor_adress" [(ngModel)]="selectedVisitor.address" placeholder="Password">
            </div>
            <div class="form-group" *ngIf='employees'>
                <label for="inputAddress">Visit To</label>
                <select class="form-control" required [(ngModel)]='selectedEmp' name="employee">
                    <option *ngFor="let c of employees.results" [ngValue]="c">{{c.name}}</option>
                </select>
            </div>
            <div class="form-group" *ngIf='departments && selectedEmp'>
                <label for="inputAddress">Department</label>
                <select class="form-control" disabled [(ngModel)]='selectedEmp.department' name="department">
                    <option *ngFor="let c of departments.results" [ngValue]="c.id">{{c.department_name}}</option>
                </select>
            </div>
            <div class="form-group">
                <label for="inputAddress">Purpose</label>
                <input type="text" required class="form-control" id="inputAdress" name="purpose" [(ngModel)]="purpose">
            </div>
            
            <button type="submit" class="btn btn-primary" data-dismiss="modal" (click)="myform.form.valid && onSubmit(myform)">Sign in</button>
          </form>
        </div>
      </div>
      <!-- <div class="modal-footer d-flex justify-content-center">
        <button class="btn btn-indigo">Send <i class="fas fa-paper-plane-o ml-1"></i></button>
      </div> -->
    </div>
  </div>
</div>